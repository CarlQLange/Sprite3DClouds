/*
* Sprite3D.js
* Visit the internets for documentation, updates and examples.
* https://github.com/boblemarin/Sprite3D.js
* http://minimal.be/lab/Sprite3D
*
* Copyright (c) 2010 boblemarin http://www.minimal.be
* 
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
* 
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/
function Sprite3D(a){a==null&&(a=document.createElement("div"));a.style.webkitTransformStyle="preserve-3d";a.style.margin="0px";a.style.padding="0px";a.style.position="absolute";a.style.webkitTransform="translateZ(0px)";this.domElement=a;this.style=a.style;this.children=[]}Sprite3D.prototype.x=0;Sprite3D.prototype.y=0;Sprite3D.prototype.z=0;Sprite3D.prototype.rotationX=0;Sprite3D.prototype.rotationY=0;Sprite3D.prototype.rotationZ=0;Sprite3D.prototype.scaleX=1;Sprite3D.prototype.scaleY=1;
Sprite3D.prototype.scaleZ=1;Sprite3D.prototype.width=0;Sprite3D.prototype.height=0;Sprite3D.prototype.regX=0;Sprite3D.prototype.regY=0;Sprite3D.prototype.regZ=0;Sprite3D.prototype.tileWidth=0;Sprite3D.prototype.tileHeight=0;Sprite3D.prototype.children=[];Sprite3D.prototype.numChildren=0;Sprite3D.prototype.rotateFirst=!1;Sprite3D.prototype.setX=function(a){this.x=a;return this};Sprite3D.prototype.setY=function(a){this.y=a;return this};Sprite3D.prototype.setZ=function(a){this.z=a;return this};
Sprite3D.prototype.setPosition=function(a,b,c){this.x=a;this.y=b;this.z=c;return this};Sprite3D.prototype.moveX=function(a){this.x+=a;return this};Sprite3D.prototype.moveY=function(a){this.y+=a;return this};Sprite3D.prototype.moveZ=function(a){this.z+=a;return this};Sprite3D.prototype.move=function(a,b,c){this.x+=a;this.y+=b;this.z+=c;return this};Sprite3D.prototype.setRotationX=function(a){this.rotationX=a;return this};Sprite3D.prototype.setRotationY=function(a){this.rotationY=a;return this};
Sprite3D.prototype.setRotationZ=function(a){this.rotationZ=a;return this};Sprite3D.prototype.setRotation=function(a,b,c){this.rotationX=a;this.rotationY=b;this.rotationZ=c;return this};Sprite3D.prototype.rotateX=function(a){this.rotationX+=a;return this};Sprite3D.prototype.rotateY=function(a){this.rotationY+=a;return this};Sprite3D.prototype.rotateZ=function(a){this.rotationZ+=a;return this};Sprite3D.prototype.rotate=function(a,b,c){this.rotationX+=a;this.rotationY+=b;this.rotationZ+=c;return this};
Sprite3D.prototype.setScaleX=function(a){this.scaleX=a;return this};Sprite3D.prototype.setScaleY=function(a){this.scaleY=a;return this};Sprite3D.prototype.setScaleZ=function(a){this.scaleZ=a;return this};Sprite3D.prototype.setScale=function(a,b,c){this.scaleX=a;this.scaleY=b;this.scaleZ=c;return this};Sprite3D.prototype.setRegistrationPoint=function(a,b,c){this.regX=a;this.regY=b;this.regZ=c;return this};
Sprite3D.prototype.setTransformOrigin=function(a,b){this.style.webkitTransformOrigin=a+" "+b;return this};Sprite3D.prototype.setSize=function(a,b){this.style.width=(this.width=a)+"px";this.style.height=(this.height=b)+"px";return this};Sprite3D.prototype.setOpacity=function(a){this.style.opacity=this.alpha=a;return this};Sprite3D.prototype.getOpacity=function(){return this.alpha};Sprite3D.prototype.setClassName=function(a){this.domElement.className=a;return this};Sprite3D.prototype.getClassName=function(){return this.domElement.className};
Sprite3D.prototype.addClassName=function(a){this.domElement.className+=" "+a+" ";return this};Sprite3D.prototype.removeClassName=function(a){this.domElement.className=this.domElement.className.replace(a,"");return this};Sprite3D.prototype.setId=function(a){this.domElement.id=a;return this};Sprite3D.prototype.getId=function(){return this.domElement.id};Sprite3D.prototype.setCSS=function(a,b){this.domElement.style[a]=b;return this};Sprite3D.prototype.getCSS=function(a){return this.domElement.style[a]};
Sprite3D.prototype.setInnerHTML=function(a){this.domElement.innerHTML=a;return this};Sprite3D.prototype.setTileSize=function(a,b){this.tileWidth=a;this.tileHeight=b;return this};Sprite3D.prototype.setTilePosition=function(a,b){this.style.backgroundPosition="-"+a*this.tileWidth+"px -"+b*this.tileHeight+"px";return this};Sprite3D.prototype.setProperty=function(a,b){this[a]=b;return this};Sprite3D.prototype.setRotateFirst=function(a){this.rotateFirst=a;return this};
Sprite3D.prototype.update=function(){p="translate3d("+(this.x-this.regX)+"px,"+(this.y-this.regY)+"px,"+(this.z-this.regZ)+"px) ";rx="rotateX("+this.rotationX+"deg) ";ry="rotateY("+this.rotationY+"deg) ";rz="rotateZ("+this.rotationZ+"deg) ";s="scale3d("+this.scaleX+", "+this.scaleY+", "+this.scaleX+") ";this.style.webkitTransform=this.rotateFirst?rz+ry+rx+p+s:p+rx+ry+rz+s;return this};
Sprite3D.prototype.updateAll=function(){this.update();this.style.opacity=this.alpha;this.style.width=this.width+"px";this.style.height=this.height+"px";return this.update()};Sprite3D.prototype.updateChildren=function(){for(i=0;i<this.numChildren;i++)this.children[i].update();return this};Sprite3D.prototype.updateChildrenAll=function(){for(i=0;i<this.numChildren;i++)this.children[i].updateAll();return this};
Sprite3D.prototype.updateWithChildren=function(a){this.update();for(i=0;i<this.numChildren;i++)a?this.children[i].updateWithChildren(recurse):this.children[i].update();return this};Sprite3D.prototype.addChild=function(a){this.numChildren=this.children.push(a);this.domElement.appendChild(a.domElement);return a};Sprite3D.prototype.removeChild=function(a){a=this.children.indexOf(a);if(a>-1)return this.removeChildAt(a);return null};
Sprite3D.prototype.removeChildAt=function(a){--this.numChildren;this.domElement.removeChild(this.children[a].domElement);return this.children.splice(a,1)[0]};Sprite3D.prototype.findFromDOMElement=function(a){for(i=0;i<this.numChildren;i++)if(a==this.children[i].domElement)return this.children[i];return null};Sprite3D.prototype.addEventListener=function(a,b){var c=this;this.domElement.addEventListener(a,function(a){b(a,c)});return this};
Sprite3D.prototype.removeEventListener=function(a,b){this.domElement.removeEventListener(a,b);return this};Sprite3D.createCenteredContainer=function(){var a=document.createElement("div"),b=a.style;b.webkitPerspective="800";b.webkitPerspectiveOrigin="0 0";b.webkitTransformOrigin="0 0";b.webkitTransform="translateZ(0px)";b.position="absolute";b.top="50%";b.left="50%";b.margin="0px";b.padding="0px";document.body.appendChild(a);return new Sprite3D(a)};
Sprite3D.createTopLeftCenteredContainer=function(){var a=document.createElement("div"),b=a.style;b.webkitPerspective="800";b.webkitTransform="translateZ(0px)";b.position="relative";document.body.appendChild(a);return new Sprite3D(a)};Sprite3D.isSupported=function(){return"webkitPerspective"in document.body.style};